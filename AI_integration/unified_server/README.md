# 통합 AI 서버 (TTS & VQA)

이 프로젝트는 음성 복제 기능이 포함된 텍스트 음성 변환(TTS)과 시각적 질의응답(VQA) 기능을 하나의 FastAPI 애플리케이션으로 통합한 AI 서버입니다.

## 주요 기능

- **시각적 질의응답 (VQA):**
  - 이미지를 업로드하고 한국어로 질문할 수 있습니다.
  - 핵심 VQA 기능으로 VILT 모델을 사용합니다.
  - 컨텍스트 보강을 위해 YOLO 모델로 객체를 탐지합니다.
  - 외부 LLM(OpenRouter API)을 사용하여 더 자연스럽고 아이들의 눈높이에 맞는 답변을 생성합니다.

- **텍스트 음성 변환 (TTS):**
  - 짧은 음성 파일을 업로드하여 나만의 음성 프로필을 생성할 수 있습니다.
  - 생성된 음성 프로필을 사용하여 한국어 텍스트를 음성으로 변환합니다.
  - Zonos 음성 복제 모델을 기반으로 합니다.

## 설치 및 실행 방법

서버를 설정하고 실행하려면 아래 단계를 따르세요.

### 1. 프로젝트 디렉토리로 이동

터미널을 열고 `unified_server` 디렉토리로 이동합니다.
```bash
cd path/to/unified_server
```

### 2. 가상 환경 생성 및 활성화

파이썬 가상 환경을 사용하는 것을 강력히 권장합니다.

```bash
# 가상 환경 생성
python3 -m venv venv

# 가상 환경 활성화 (리눅스/WSL/macOS 기준)
source venv/bin/activate
```

### 3. 의존성 라이브러리 설치

`requirements.txt` 파일에 명시된 모든 파이썬 라이브러리를 설치합니다.

**주의:** 이 단계는 대용량 AI 모델을 다운로드하고 복잡한 패키지를 설치하는 과정이 포함되어 있습니다. 인터넷 속도와 컴퓨터 사양에 따라 **상당한 시간(10분 ~ 20분 이상)이 소요될 수 있습니다.**

```bash
pip install -r requirements.txt
```

### 4. 환경 변수 파일 생성

VQA 모듈은 답변 보강을 위해 OpenRouter API를 사용합니다. `unified_server` 디렉토리 안에 `.env` 파일을 생성하고 아래 내용과 같이 API 키를 추가하세요.

```
# unified_server/.env
OPENROUTER_API_KEY='여기에_실제_API_키를_입력하세요'
```

## 서버 실행

설치가 완료되면 `uvicorn`을 사용하여 서버를 실행할 수 있습니다.

```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

서버가 시작되면 모든 AI 모델을 메모리에 로드하며, 터미널에 진행 상황이 출력됩니다.

서버가 실행된 후, 웹 브라우저에서 `http://localhost:8000/docs` 주소로 접속하면 API 문서를 확인하고 직접 테스트해볼 수 있습니다.

## 인터랙티브 테스트 클라이언트 사용법

서버의 기능을 쉽게 테스트할 수 있도록 상위 폴더에 `network_client.py`가 준비되어 있습니다.

### 1. 클라이언트 의존성 설치

클라이언트는 `requests` 라이브러리를 사용합니다.
```bash
pip install requests
```

### 2. 클라이언트 실행

서버가 실행 중인 상태에서, 새 터미널을 열고 상위 `AI_integration` 디렉토리로 이동하여 클라이언트를 실행합니다.
```bash
# AI_integration/ 디렉토리에서 실행
python network_client.py
```

클라이언트를 실행하면 VQA 테스트, TTS 프로필 생성, 음성 합성 등의 기능을 선택할 수 있는 메뉴가 나타납니다. 화면의 안내에 따라 테스트를 진행하세요.
